<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Drag and Drop List</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .container {
            display: flex;
            flex-direction: row; /* Change to column for vertical layout */
            gap: 20px;
        }
        .item {
            width: 100px;
            height: 100px;
            background-color: #4CAF50;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            cursor: grab;
            border-radius: 10px;
        }
        .item.dragging {
            opacity: 0.5;
        }
        .placeholder {
            border: 2px dashed #ccc;
            height: 100px;
            width: 100px;
        }
    </style>
</head>
<body>
    <div class="container" id="itemContainer"></div>

    <script>
        let itemList = ['1', '2', '3', '4', '5'];  // This can be any number of items
        const container = document.getElementById('itemContainer');
        let draggedItem = null;
        let placeholder = null;

        // Function to render items dynamically based on itemList
        function renderItems() {
            container.innerHTML = ''; // Clear existing elements
            itemList.forEach((item, index) => {
                const div = document.createElement('div');
                div.classList.add('item');
                div.setAttribute('draggable', 'true');
                div.setAttribute('data-index', index);
                div.textContent = item;
                container.appendChild(div);
                attachDragEvents(div);
            });
        }

        // Attach drag and drop events dynamically to each item
        function attachDragEvents(item) {
            item.addEventListener('dragstart', (e) => {
                draggedItem = item;
                setTimeout(() => {
                    item.classList.add('dragging');
                }, 0);
                placeholder = document.createElement('div');
                placeholder.classList.add('placeholder');
            });
            
            item.addEventListener('dragend', (e) => {
                item.classList.remove('dragging');
                placeholder.remove();
                updateItemList();
            });
        }

        // Handle dragover to allow dropping in between items
        container.addEventListener('dragover', (e) => {
            e.preventDefault();
            const afterElement = getDragAfterElement(container, e.clientX, e.clientY);
            if (afterElement == null) {
                container.appendChild(placeholder);
            } else {
                container.insertBefore(placeholder, afterElement);
            }
        });

        // Handle dropping the item
        container.addEventListener('drop', (e) => {
            e.preventDefault();
            container.insertBefore(draggedItem, placeholder);
        });

        // Function to get the next element relative to the current drag position
        function getDragAfterElement(container, x, y) {
            const elements = [...container.querySelectorAll('.item:not(.dragging)')];

            return elements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Update the itemList array based on the new order in the DOM
        function updateItemList() {
            const newOrder = Array.from(container.children).map(item => item.textContent);
            itemList = newOrder;
            console.log("Updated item list:", itemList);
        }

        // Initial render
        renderItems();

    </script>
</body>
</html>
